
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>piqs.tests.test_dicke &#8212; piqs  documentation</title>
    <link rel="stylesheet" href="../../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for piqs.tests.test_dicke</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Tests for Permutation Invariance methods.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">numpy.testing</span> <span class="k">import</span> <span class="p">(</span><span class="n">assert_</span><span class="p">,</span> <span class="n">run_module_suite</span><span class="p">,</span> <span class="n">assert_raises</span><span class="p">,</span>
                           <span class="n">assert_array_equal</span><span class="p">,</span> <span class="n">assert_array_almost_equal</span><span class="p">,</span>
                           <span class="n">assert_almost_equal</span><span class="p">,</span> <span class="n">assert_equal</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">qutip</span> <span class="k">import</span> <span class="n">Qobj</span>
<span class="kn">from</span> <span class="nn">piqs.cy.dicke</span> <span class="k">import</span> <span class="p">(</span><span class="n">get_blocks</span><span class="p">,</span> <span class="n">j_min</span><span class="p">,</span> <span class="n">j_vals</span><span class="p">,</span> <span class="n">m_vals</span><span class="p">,</span>
                     <span class="n">_num_dicke_states</span><span class="p">,</span> <span class="n">_num_dicke_ladders</span><span class="p">,</span>
                     <span class="n">get_index</span><span class="p">,</span> <span class="n">jmm1_dictionary</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">piqs.cy.dicke</span> <span class="k">import</span> <span class="n">Dicke</span> <span class="k">as</span> <span class="n">_Dicke</span>
<span class="kn">from</span> <span class="nn">piqs</span> <span class="k">import</span> <span class="o">*</span>


<div class="viewcode-block" id="TestDicke"><a class="viewcode-back" href="../../../piqs.tests.html#piqs.tests.test_dicke.TestDicke">[docs]</a><span class="k">class</span> <span class="nc">TestDicke</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A test class for the Permutational Invariant Quantum Solver.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="TestDicke.test_num_dicke_states"><a class="viewcode-back" href="../../../piqs.tests.html#piqs.tests.test_dicke.TestDicke.test_num_dicke_states">[docs]</a>    <span class="k">def</span> <span class="nf">test_num_dicke_states</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test the `num_dicke_state` function.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">N_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">123</span><span class="p">]</span>
        <span class="n">dicke_states</span> <span class="o">=</span> <span class="p">[</span><span class="n">num_dicke_states</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">N_list</span><span class="p">]</span>
        <span class="n">assert_array_equal</span><span class="p">(</span><span class="n">dicke_states</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span>
                                          <span class="mi">2601</span><span class="p">,</span> <span class="mi">3906</span><span class="p">])</span>
        <span class="n">N</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">assert_raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">num_dicke_states</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
        <span class="n">N</span> <span class="o">=</span> <span class="mf">0.2</span>
        <span class="n">assert_raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">num_dicke_states</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span></div>

<div class="viewcode-block" id="TestDicke.test_num_tls"><a class="viewcode-back" href="../../../piqs.tests.html#piqs.tests.test_dicke.TestDicke.test_num_tls">[docs]</a>    <span class="k">def</span> <span class="nf">test_num_tls</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test the `num_two_level` function.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">N_dicke</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">2601</span><span class="p">,</span> <span class="mi">3906</span><span class="p">]</span>
        <span class="n">N</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">123</span><span class="p">]</span>
        <span class="n">calculated_N</span> <span class="o">=</span> <span class="p">[</span><span class="n">num_tls</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">N_dicke</span><span class="p">]</span>
        <span class="n">assert_array_equal</span><span class="p">(</span><span class="n">calculated_N</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span></div>

<div class="viewcode-block" id="TestDicke.test_num_dicke_ladders"><a class="viewcode-back" href="../../../piqs.tests.html#piqs.tests.test_dicke.TestDicke.test_num_dicke_ladders">[docs]</a>    <span class="k">def</span> <span class="nf">test_num_dicke_ladders</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test the `_num_dicke_ladders` function.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ndl_true</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
        <span class="n">ndl</span> <span class="o">=</span> <span class="p">[</span><span class="n">num_dicke_ladders</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="k">for</span> <span class="n">N</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)]</span>
        <span class="n">assert_array_equal</span><span class="p">(</span><span class="n">ndl</span><span class="p">,</span> <span class="n">ndl_true</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">test_get_blocks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test the function to get blocks.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">N_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
        <span class="n">blocks</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">12</span><span class="p">]),</span>
                  <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">8</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">20</span><span class="p">])]</span>
        <span class="n">calculated_blocks</span> <span class="o">=</span> <span class="p">[</span><span class="n">get_blocks</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">N_list</span><span class="p">]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">calculated_blocks</span><span class="p">,</span> <span class="n">blocks</span><span class="p">):</span>
            <span class="n">assert_array_equal</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>

<div class="viewcode-block" id="TestDicke.test_j_vals"><a class="viewcode-back" href="../../../piqs.tests.html#piqs.tests.test_dicke.TestDicke.test_j_vals">[docs]</a>    <span class="k">def</span> <span class="nf">test_j_vals</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test calculation of j values for given N.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">N_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
        <span class="n">j_vals_real</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]),</span>
                       <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">]),</span>
                       <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">]),</span>
                       <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">])]</span>
        <span class="n">j_vals_calc</span> <span class="o">=</span> <span class="p">[</span><span class="n">j_vals</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">N_list</span><span class="p">]</span>

        <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">j_vals_calc</span><span class="p">,</span> <span class="n">j_vals_real</span><span class="p">):</span>
            <span class="n">assert_array_equal</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span></div>

<div class="viewcode-block" id="TestDicke.test_m_vals"><a class="viewcode-back" href="../../../piqs.tests.html#piqs.tests.test_dicke.TestDicke.test_m_vals">[docs]</a>    <span class="k">def</span> <span class="nf">test_m_vals</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test calculation of m values for a particular j.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">j_list</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">]</span>
        <span class="n">m_real</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span>
                  <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">]),</span>
                  <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span>
                  <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">])]</span>

        <span class="n">m_calc</span> <span class="o">=</span> <span class="p">[</span><span class="n">m_vals</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">j_list</span><span class="p">]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">m_real</span><span class="p">,</span> <span class="n">m_calc</span><span class="p">):</span>
            <span class="n">assert_array_equal</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span></div>

<div class="viewcode-block" id="TestDicke.test_get_index"><a class="viewcode-back" href="../../../piqs.tests.html#piqs.tests.test_dicke.TestDicke.test_get_index">[docs]</a>    <span class="k">def</span> <span class="nf">test_get_index</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test the index fetching function for given j, m, m1 value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">N</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">jmm1_list</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">),</span>
                     <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">)]</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>

        <span class="n">blocks</span> <span class="o">=</span> <span class="n">get_blocks</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">calculated_indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">get_index</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">jmm1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">jmm1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                        <span class="n">jmm1</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">blocks</span><span class="p">)</span>
                              <span class="k">for</span> <span class="n">jmm1</span> <span class="ow">in</span> <span class="n">jmm1_list</span><span class="p">]</span>
        <span class="n">assert_array_almost_equal</span><span class="p">(</span><span class="n">calculated_indices</span><span class="p">,</span> <span class="n">indices</span><span class="p">)</span>
        <span class="n">N</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">blocks</span> <span class="o">=</span> <span class="n">get_blocks</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">jmm1_list</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
                     <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
                     <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
                     <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                   <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                   <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                   <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)]</span>
        <span class="n">calculated_indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">get_index</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">jmm1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">jmm1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                        <span class="n">jmm1</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">blocks</span><span class="p">)</span>
                              <span class="k">for</span> <span class="n">jmm1</span> <span class="ow">in</span> <span class="n">jmm1_list</span><span class="p">]</span>
        <span class="n">assert_array_almost_equal</span><span class="p">(</span><span class="n">calculated_indices</span><span class="p">,</span> <span class="n">indices</span><span class="p">)</span>
        <span class="n">N</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="n">blocks</span> <span class="o">=</span> <span class="n">get_blocks</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">jmm1_list</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">),</span>
                     <span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">),</span>
                     <span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
                     <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
                     <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">)]</span>

        <span class="n">indices</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
                   <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                   <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
                   <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)]</span>

        <span class="n">calculated_indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">get_index</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">jmm1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">jmm1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                        <span class="n">jmm1</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">blocks</span><span class="p">)</span>
                              <span class="k">for</span> <span class="n">jmm1</span> <span class="ow">in</span> <span class="n">jmm1_list</span><span class="p">]</span>
        <span class="n">assert_array_almost_equal</span><span class="p">(</span><span class="n">calculated_indices</span><span class="p">,</span> <span class="n">indices</span><span class="p">)</span></div>

<div class="viewcode-block" id="TestDicke.test_jmm1_dictionary"><a class="viewcode-back" href="../../../piqs.tests.html#piqs.tests.test_dicke.TestDicke.test_jmm1_dictionary">[docs]</a>    <span class="k">def</span> <span class="nf">test_jmm1_dictionary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test the function to generate the mapping from jmm1 to ik matrix.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">d1</span><span class="p">,</span> <span class="n">d2</span><span class="p">,</span> <span class="n">d3</span><span class="p">,</span> <span class="n">d4</span> <span class="o">=</span> <span class="n">jmm1_dictionary</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">d1_correct</span> <span class="o">=</span> <span class="p">{(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">),</span>
                      <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">)}</span>

        <span class="n">d2_correct</span> <span class="o">=</span> <span class="p">{(</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">):</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">):</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                      <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">):</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                      <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">):</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)}</span>

        <span class="n">d3_correct</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="mi">1</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">),</span>
                      <span class="mi">2</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
                      <span class="mi">3</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">)}</span>

        <span class="n">d4_correct</span> <span class="o">=</span> <span class="p">{(</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">):</span> <span class="mi">3</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">):</span> <span class="mi">2</span><span class="p">,</span>
                      <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">):</span> <span class="mi">0</span><span class="p">}</span>

        <span class="n">assert_equal</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="n">d1_correct</span><span class="p">)</span>
        <span class="n">assert_equal</span><span class="p">(</span><span class="n">d2</span><span class="p">,</span> <span class="n">d2_correct</span><span class="p">)</span>
        <span class="n">assert_equal</span><span class="p">(</span><span class="n">d3</span><span class="p">,</span> <span class="n">d3_correct</span><span class="p">)</span>
        <span class="n">assert_equal</span><span class="p">(</span><span class="n">d4</span><span class="p">,</span> <span class="n">d4_correct</span><span class="p">)</span>

        <span class="n">d1</span><span class="p">,</span> <span class="n">d2</span><span class="p">,</span> <span class="n">d3</span><span class="p">,</span> <span class="n">d4</span> <span class="o">=</span> <span class="n">jmm1_dictionary</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

        <span class="n">d1_correct</span> <span class="o">=</span> <span class="p">{(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">),</span>
                      <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                      <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
                      <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">),</span>
                      <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)}</span>

        <span class="n">d2_correct</span> <span class="o">=</span> <span class="p">{(</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0</span><span class="p">):</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">):</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                      <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">):</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">):</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                      <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">):</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">):</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                      <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">):</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">):</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                      <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">):</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">):</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)}</span>

        <span class="n">d3_correct</span> <span class="o">=</span> <span class="p">{</span><span class="mi">15</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0</span><span class="p">),</span> <span class="mi">10</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">),</span>
                      <span class="mi">9</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="mi">8</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                      <span class="mi">6</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">),</span> <span class="mi">5</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
                      <span class="mi">4</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="mi">2</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">),</span>
                      <span class="mi">1</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="mi">0</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)}</span>

        <span class="n">d4_correct</span> <span class="o">=</span> <span class="p">{(</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0</span><span class="p">):</span> <span class="mi">15</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">):</span> <span class="mi">10</span><span class="p">,</span>
                      <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">):</span> <span class="mi">9</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">):</span> <span class="mi">8</span><span class="p">,</span>
                      <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">):</span> <span class="mi">6</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">):</span> <span class="mi">5</span><span class="p">,</span>
                      <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">):</span> <span class="mi">4</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">):</span> <span class="mi">2</span><span class="p">,</span>
                      <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">):</span> <span class="mi">0</span><span class="p">}</span>

        <span class="n">assert_equal</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="n">d1_correct</span><span class="p">)</span>
        <span class="n">assert_equal</span><span class="p">(</span><span class="n">d2</span><span class="p">,</span> <span class="n">d2_correct</span><span class="p">)</span>
        <span class="n">assert_equal</span><span class="p">(</span><span class="n">d3</span><span class="p">,</span> <span class="n">d3_correct</span><span class="p">)</span>
        <span class="n">assert_equal</span><span class="p">(</span><span class="n">d4</span><span class="p">,</span> <span class="n">d4_correct</span><span class="p">)</span></div>

<div class="viewcode-block" id="TestDicke.test_lindbladian"><a class="viewcode-back" href="../../../piqs.tests.html#piqs.tests.test_dicke.TestDicke.test_lindbladian">[docs]</a>    <span class="k">def</span> <span class="nf">test_lindbladian</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test the generation of the Lindbladian matrix.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">N</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">gCE</span> <span class="o">=</span> <span class="mf">0.5</span>
        <span class="n">gCD</span> <span class="o">=</span> <span class="mf">0.5</span>
        <span class="n">gCP</span> <span class="o">=</span> <span class="mf">0.5</span>
        <span class="n">gE</span> <span class="o">=</span> <span class="mf">0.1</span>
        <span class="n">gD</span> <span class="o">=</span> <span class="mf">0.1</span>
        <span class="n">gP</span> <span class="o">=</span> <span class="mf">0.1</span>

        <span class="n">system</span> <span class="o">=</span> <span class="n">Dicke</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">emission</span><span class="o">=</span><span class="n">gE</span><span class="p">,</span> <span class="n">pumping</span><span class="o">=</span><span class="n">gP</span><span class="p">,</span> <span class="n">dephasing</span><span class="o">=</span><span class="n">gD</span><span class="p">,</span>
                       <span class="n">collective_emission</span><span class="o">=</span><span class="n">gCE</span><span class="p">,</span> <span class="n">collective_pumping</span><span class="o">=</span><span class="n">gCP</span><span class="p">,</span>
                       <span class="n">collective_dephasing</span><span class="o">=</span><span class="n">gCD</span><span class="p">)</span>

        <span class="n">lindbladian</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">lindbladian</span><span class="p">()</span>
        <span class="n">Ldata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;complex&quot;</span><span class="p">)</span>
        <span class="n">Ldata</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">]</span>
        <span class="n">Ldata</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">Ldata</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.9</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">Ldata</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6</span><span class="p">]</span>

        <span class="n">lindbladian_correct</span> <span class="o">=</span> <span class="n">Qobj</span><span class="p">(</span><span class="n">Ldata</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="p">[[[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">]]],</span>
                                   <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
        <span class="n">assert_array_almost_equal</span><span class="p">(</span><span class="n">lindbladian</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">toarray</span><span class="p">(),</span> <span class="n">Ldata</span><span class="p">)</span>
        <span class="n">N</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">gCE</span> <span class="o">=</span> <span class="mf">0.5</span>
        <span class="n">gCD</span> <span class="o">=</span> <span class="mf">0.5</span>
        <span class="n">gCP</span> <span class="o">=</span> <span class="mf">0.5</span>
        <span class="n">gE</span> <span class="o">=</span> <span class="mf">0.1</span>
        <span class="n">gD</span> <span class="o">=</span> <span class="mf">0.1</span>
        <span class="n">gP</span> <span class="o">=</span> <span class="mf">0.1</span>
        <span class="n">system</span> <span class="o">=</span> <span class="n">Dicke</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">emission</span><span class="o">=</span><span class="n">gE</span><span class="p">,</span> <span class="n">pumping</span><span class="o">=</span><span class="n">gP</span><span class="p">,</span> <span class="n">dephasing</span><span class="o">=</span><span class="n">gD</span><span class="p">,</span>
                       <span class="n">collective_emission</span><span class="o">=</span><span class="n">gCE</span><span class="p">,</span> <span class="n">collective_pumping</span><span class="o">=</span><span class="n">gCP</span><span class="p">,</span>
                       <span class="n">collective_dephasing</span><span class="o">=</span><span class="n">gCD</span><span class="p">)</span>

        <span class="n">lindbladian</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">lindbladian</span><span class="p">()</span>

        <span class="n">Ldata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;complex&quot;</span><span class="p">)</span>
        <span class="n">Ldata</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">Ldata</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">5</span><span class="p">],</span> <span class="n">Ldata</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">15</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">0.1</span>
        <span class="n">Ldata</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">Ldata</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.1</span>
        <span class="n">Ldata</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.2999999999999998</span>
        <span class="n">Ldata</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">Ldata</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.1</span>
        <span class="n">Ldata</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">Ldata</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">Ldata</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">Ldata</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.25</span><span class="p">,</span>
                                                                <span class="mf">1.1</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span>
        <span class="n">Ldata</span><span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">Ldata</span><span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span>
        <span class="n">Ldata</span><span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.2999999999999998</span>
        <span class="n">Ldata</span><span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">Ldata</span><span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span>
        <span class="n">Ldata</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">Ldata</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">Ldata</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">0.1</span>
        <span class="n">Ldata</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">Ldata</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">Ldata</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">Ldata</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.1</span><span class="p">,</span>
                                                                    <span class="mf">0.05</span><span class="p">,</span>
                                                                    <span class="mf">0.1</span><span class="p">,</span>
                                                                    <span class="o">-</span><span class="mf">0.25</span><span class="p">)</span>
        <span class="n">lindbladian_correct</span> <span class="o">=</span> <span class="n">Qobj</span><span class="p">(</span><span class="n">Ldata</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="p">[[[</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">]]],</span>
                                   <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>
        <span class="n">assert_array_almost_equal</span><span class="p">(</span><span class="n">lindbladian</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">toarray</span><span class="p">(),</span> <span class="n">Ldata</span><span class="p">)</span></div>

<div class="viewcode-block" id="TestDicke.test_gamma"><a class="viewcode-back" href="../../../piqs.tests.html#piqs.tests.test_dicke.TestDicke.test_gamma">[docs]</a>    <span class="k">def</span> <span class="nf">test_gamma</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test the calculation of various gamma values for diagonal system.</span>

<span class="sd">        For N = 6 |j, m&gt; would be :</span>

<span class="sd">        | 3, 3&gt;</span>
<span class="sd">        | 3, 2&gt; | 2, 2&gt;</span>
<span class="sd">        | 3, 1&gt; | 2, 1&gt; | 1, 1&gt;</span>
<span class="sd">        | 3, 0&gt; | 2, 0&gt; | 1, 0&gt; |0, 0&gt;</span>
<span class="sd">        | 3,-1&gt; | 2,-1&gt; | 1,-1&gt;</span>
<span class="sd">        | 3,-2&gt; | 2,-2&gt;</span>
<span class="sd">        | 3,-3&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">N</span> <span class="o">=</span> <span class="mi">6</span>
        <span class="n">collective_emission</span> <span class="o">=</span> <span class="mf">1.</span>
        <span class="n">emission</span> <span class="o">=</span> <span class="mf">1.</span>
        <span class="n">dephasing</span> <span class="o">=</span> <span class="mf">1.</span>
        <span class="n">pumping</span> <span class="o">=</span> <span class="mf">1.</span>
        <span class="n">collective_pumping</span> <span class="o">=</span> <span class="mf">1.</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">_Dicke</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">collective_emission</span><span class="o">=</span><span class="n">collective_emission</span><span class="p">,</span>
                       <span class="n">emission</span><span class="o">=</span><span class="n">emission</span><span class="p">,</span> <span class="n">dephasing</span><span class="o">=</span><span class="n">dephasing</span><span class="p">,</span>
                       <span class="n">pumping</span><span class="o">=</span><span class="n">pumping</span><span class="p">,</span> <span class="n">collective_pumping</span><span class="o">=</span><span class="n">collective_pumping</span><span class="p">)</span>
        <span class="n">tau_calculated</span> <span class="o">=</span> <span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">gamma3</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span>
                          <span class="n">model</span><span class="o">.</span><span class="n">gamma2</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span>
                          <span class="n">model</span><span class="o">.</span><span class="n">gamma4</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span>
                          <span class="n">model</span><span class="o">.</span><span class="n">gamma5</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
                          <span class="n">model</span><span class="o">.</span><span class="n">gamma1</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
                          <span class="n">model</span><span class="o">.</span><span class="n">gamma6</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
                          <span class="n">model</span><span class="o">.</span><span class="n">gamma7</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)),</span>
                          <span class="n">model</span><span class="o">.</span><span class="n">gamma8</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)),</span>
                          <span class="n">model</span><span class="o">.</span><span class="n">gamma9</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))]</span>
        <span class="n">tau_real</span> <span class="o">=</span> <span class="p">[</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">8.</span><span class="p">,</span> <span class="mf">0.333333</span><span class="p">,</span>
                    <span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">19.5</span><span class="p">,</span> <span class="mf">0.666667</span><span class="p">,</span>
                    <span class="mf">2.</span><span class="p">,</span> <span class="mf">8.</span><span class="p">,</span> <span class="mf">0.333333</span><span class="p">]</span>
        <span class="n">assert_array_almost_equal</span><span class="p">(</span><span class="n">tau_calculated</span><span class="p">,</span> <span class="n">tau_real</span><span class="p">)</span></div>

<div class="viewcode-block" id="TestDicke.test_jspin"><a class="viewcode-back" href="../../../piqs.tests.html#piqs.tests.test_dicke.TestDicke.test_jspin">[docs]</a>    <span class="k">def</span> <span class="nf">test_jspin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test calculation of the j algebra relation for the total operators.</span>

<span class="sd">        The jx, jy, jz, jp and jm for a given N in the (j, m, m1) basis should</span>
<span class="sd">        follow the following algebra</span>
<span class="sd">        [jx, jy] == 1j * jz, [jp, jm] == 2 * jz, jx^2 + jy^2 + jz^2 == j2^2.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">N_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">nn</span> <span class="ow">in</span> <span class="n">N_list</span><span class="p">:</span>
            <span class="c1"># tests 1</span>
            <span class="p">[</span><span class="n">jx</span><span class="p">,</span> <span class="n">jy</span><span class="p">,</span> <span class="n">jz</span><span class="p">]</span> <span class="o">=</span> <span class="n">jspin</span><span class="p">(</span><span class="n">nn</span><span class="p">)</span>
            <span class="n">jp</span><span class="p">,</span> <span class="n">jm</span> <span class="o">=</span> <span class="n">jspin</span><span class="p">(</span><span class="n">nn</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="p">),</span> <span class="n">jspin</span><span class="p">(</span><span class="n">nn</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span>
            <span class="n">test_jxjy</span> <span class="o">=</span> <span class="n">jx</span> <span class="o">*</span> <span class="n">jy</span> <span class="o">-</span> <span class="n">jy</span> <span class="o">*</span> <span class="n">jx</span>
            <span class="n">true_jxjy</span> <span class="o">=</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">jz</span>
            <span class="n">test_jpjm</span> <span class="o">=</span> <span class="n">jp</span> <span class="o">*</span> <span class="n">jm</span> <span class="o">-</span> <span class="n">jm</span> <span class="o">*</span> <span class="n">jp</span>
            <span class="n">true_jpjm</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">jz</span>

            <span class="n">assert_array_equal</span><span class="p">(</span><span class="n">test_jxjy</span><span class="p">,</span> <span class="n">true_jxjy</span><span class="p">)</span>
            <span class="n">assert_array_equal</span><span class="p">(</span><span class="n">test_jpjm</span><span class="p">,</span> <span class="n">true_jpjm</span><span class="p">)</span>

            <span class="c1"># tests 2</span>
            <span class="p">[</span><span class="n">jx</span><span class="p">,</span> <span class="n">jy</span><span class="p">,</span> <span class="n">jz</span><span class="p">]</span> <span class="o">=</span> <span class="n">jspin</span><span class="p">(</span><span class="n">nn</span><span class="p">)</span>
            <span class="n">jp</span><span class="p">,</span> <span class="n">jm</span> <span class="o">=</span> <span class="n">jspin</span><span class="p">(</span><span class="n">nn</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="p">),</span> <span class="n">jspin</span><span class="p">(</span><span class="n">nn</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span>
            <span class="n">test_jxjy</span> <span class="o">=</span> <span class="n">jx</span> <span class="o">*</span> <span class="n">jy</span> <span class="o">-</span> <span class="n">jy</span> <span class="o">*</span> <span class="n">jx</span>
            <span class="n">true_jxjy</span> <span class="o">=</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">jz</span>
            <span class="n">test_jpjm</span> <span class="o">=</span> <span class="n">jp</span> <span class="o">*</span> <span class="n">jm</span> <span class="o">-</span> <span class="n">jm</span> <span class="o">*</span> <span class="n">jp</span>
            <span class="n">true_jpjm</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">jz</span>

            <span class="n">assert_array_equal</span><span class="p">(</span><span class="n">test_jxjy</span><span class="p">,</span> <span class="n">true_jxjy</span><span class="p">)</span>
            <span class="n">assert_array_equal</span><span class="p">(</span><span class="n">test_jpjm</span><span class="p">,</span> <span class="n">true_jpjm</span><span class="p">)</span>

            <span class="n">assert_array_equal</span><span class="p">(</span><span class="n">jspin</span><span class="p">(</span><span class="n">nn</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">),</span> <span class="n">jx</span><span class="p">)</span>
            <span class="n">assert_array_equal</span><span class="p">(</span><span class="n">jspin</span><span class="p">(</span><span class="n">nn</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">),</span> <span class="n">jy</span><span class="p">)</span>
            <span class="n">assert_array_equal</span><span class="p">(</span><span class="n">jspin</span><span class="p">(</span><span class="n">nn</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">),</span> <span class="n">jz</span><span class="p">)</span>
            <span class="n">assert_array_equal</span><span class="p">(</span><span class="n">jspin</span><span class="p">(</span><span class="n">nn</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="p">),</span> <span class="n">jp</span><span class="p">)</span>
            <span class="n">assert_array_equal</span><span class="p">(</span><span class="n">jspin</span><span class="p">(</span><span class="n">nn</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">),</span> <span class="n">jm</span><span class="p">)</span>
            <span class="n">assert_raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">jspin</span><span class="p">,</span> <span class="n">nn</span><span class="p">,</span> <span class="s2">&quot;q&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TestDicke.test_j_min_"><a class="viewcode-back" href="../../../piqs.tests.html#piqs.tests.test_dicke.TestDicke.test_j_min_">[docs]</a>    <span class="k">def</span> <span class="nf">test_j_min_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test the `j_min` function.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">even</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">]</span>
        <span class="n">odd</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">even</span><span class="p">:</span>
            <span class="n">assert_</span><span class="p">(</span><span class="n">j_min</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">odd</span><span class="p">:</span>
            <span class="n">assert_</span><span class="p">(</span><span class="n">j_min</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.5</span><span class="p">)</span></div>

<div class="viewcode-block" id="TestDicke.test_energy_degeneracy"><a class="viewcode-back" href="../../../piqs.tests.html#piqs.tests.test_dicke.TestDicke.test_energy_degeneracy">[docs]</a>    <span class="k">def</span> <span class="nf">test_energy_degeneracy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test the energy degeneracy (m) of Dicke state | j, m &gt;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">true_en_deg</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">true_en_deg_even</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">20</span><span class="p">]</span>
        <span class="n">true_en_deg_odd</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">35</span><span class="p">]</span>
        <span class="n">test_en_deg</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">test_en_deg_even</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">test_en_deg_odd</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">nn</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">]:</span>
            <span class="n">test_en_deg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">energy_degeneracy</span><span class="p">(</span><span class="n">nn</span><span class="p">,</span> <span class="n">nn</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">nn</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">]:</span>
            <span class="n">test_en_deg_even</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">energy_degeneracy</span><span class="p">(</span><span class="n">nn</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">nn</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">]:</span>
            <span class="n">test_en_deg_odd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">energy_degeneracy</span><span class="p">(</span><span class="n">nn</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>
            <span class="n">test_en_deg_odd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">energy_degeneracy</span><span class="p">(</span><span class="n">nn</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>

        <span class="n">assert_array_equal</span><span class="p">(</span><span class="n">test_en_deg</span><span class="p">,</span> <span class="n">true_en_deg</span><span class="p">)</span>
        <span class="n">assert_array_equal</span><span class="p">(</span><span class="n">test_en_deg_even</span><span class="p">,</span> <span class="n">true_en_deg_even</span><span class="p">)</span>
        <span class="n">assert_array_equal</span><span class="p">(</span><span class="n">test_en_deg_odd</span><span class="p">,</span> <span class="n">true_en_deg_odd</span><span class="p">)</span></div>

<div class="viewcode-block" id="TestDicke.test_state_degeneracy"><a class="viewcode-back" href="../../../piqs.tests.html#piqs.tests.test_dicke.TestDicke.test_state_degeneracy">[docs]</a>    <span class="k">def</span> <span class="nf">test_state_degeneracy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test the calculation of the degeneracy of the Dicke state |j, m&gt;,</span>
<span class="sd">        state_degeneracy(N, j).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">true_state_deg</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">42</span><span class="p">]</span>
        <span class="n">state_deg</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">state_deg</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">nn</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]:</span>
            <span class="n">state_deg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">state_degeneracy</span><span class="p">(</span><span class="n">nn</span><span class="p">,</span> <span class="n">nn</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">nn</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]:</span>
            <span class="n">state_deg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">state_degeneracy</span><span class="p">(</span><span class="n">nn</span><span class="p">,</span> <span class="p">(</span><span class="n">nn</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">%</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">assert_array_equal</span><span class="p">(</span><span class="n">state_deg</span><span class="p">,</span> <span class="n">true_state_deg</span><span class="p">)</span>

        <span class="c1"># check error</span>
        <span class="n">assert_raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">state_degeneracy</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestDicke.test_m_degeneracy"><a class="viewcode-back" href="../../../piqs.tests.html#piqs.tests.test_dicke.TestDicke.test_m_degeneracy">[docs]</a>    <span class="k">def</span> <span class="nf">test_m_degeneracy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test the degeneracy of TLS states with same m eigenvalue.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">true_m_deg</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
        <span class="n">m_deg</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">nn</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]:</span>
            <span class="n">m_deg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m_degeneracy</span><span class="p">(</span><span class="n">nn</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="n">nn</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">%</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">assert_array_equal</span><span class="p">(</span><span class="n">m_deg</span><span class="p">,</span> <span class="n">true_m_deg</span><span class="p">)</span>

        <span class="c1"># check error</span>
        <span class="n">assert_raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">m_degeneracy</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">)</span></div>

<div class="viewcode-block" id="TestDicke.test_ap"><a class="viewcode-back" href="../../../piqs.tests.html#piqs.tests.test_dicke.TestDicke.test_ap">[docs]</a>    <span class="k">def</span> <span class="nf">test_ap</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Tests the calculation of the real coefficient A_{+}(j,m).</span>

<span class="sd">        For given values of j, m. For a Dicke state,</span>
<span class="sd">        J_{+} |j, m&gt; = A_{+}(j,m) |j, m + 1&gt;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">true_ap_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">110</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">ap_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]:</span>
            <span class="n">ap_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ap</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

        <span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">ap_list</span><span class="p">,</span> <span class="n">true_ap_list</span><span class="p">)</span></div>

<div class="viewcode-block" id="TestDicke.test_am"><a class="viewcode-back" href="../../../piqs.tests.html#piqs.tests.test_dicke.TestDicke.test_am">[docs]</a>    <span class="k">def</span> <span class="nf">test_am</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Tests the calculation of the real coefficient A_{-}(j,m).</span>

<span class="sd">        For a Dicke state,  J_{-} |j, m&gt; = A_{+}(j,m) |j, m - 1&gt;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">true_am_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">110</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span> <span class="mi">20</span><span class="p">]</span>
        <span class="n">am_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]:</span>
            <span class="n">am_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">am</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

        <span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">am_list</span><span class="p">,</span> <span class="n">true_am_list</span><span class="p">)</span></div>

<div class="viewcode-block" id="TestDicke.test_spin_algebra"><a class="viewcode-back" href="../../../piqs.tests.html#piqs.tests.test_dicke.TestDicke.test_spin_algebra">[docs]</a>    <span class="k">def</span> <span class="nf">test_spin_algebra</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Tests the function that creates the SU2 algebra in uncoupled basis.</span>
<span class="sd">        The list [sx, sy, sz, sp, sm] is checked for N = 2.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sx1</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
               <span class="p">[</span><span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
               <span class="p">[</span><span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
               <span class="p">[</span><span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">]]</span>

        <span class="n">sx2</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
               <span class="p">[</span><span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
               <span class="p">[</span><span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
               <span class="p">[</span><span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">]]</span>

        <span class="n">sy1</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">-</span> <span class="mf">0.5</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
               <span class="p">[</span><span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">-</span> <span class="mf">0.5</span><span class="n">j</span><span class="p">],</span>
               <span class="p">[</span><span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.5</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
               <span class="p">[</span><span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.5</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">]]</span>

        <span class="n">sy2</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">-</span> <span class="mf">0.5</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
               <span class="p">[</span><span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.5</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
               <span class="p">[</span><span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">-</span> <span class="mf">0.5</span><span class="n">j</span><span class="p">],</span>
               <span class="p">[</span><span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.5</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">]]</span>

        <span class="n">sz1</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
               <span class="p">[</span><span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
               <span class="p">[</span><span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
               <span class="p">[</span><span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">]]</span>

        <span class="n">sz2</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
               <span class="p">[</span><span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
               <span class="p">[</span><span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
               <span class="p">[</span><span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">]]</span>

        <span class="n">sp1</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
               <span class="p">[</span><span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
               <span class="p">[</span><span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
               <span class="p">[</span><span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">]]</span>

        <span class="n">sp2</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
               <span class="p">[</span><span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
               <span class="p">[</span><span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
               <span class="p">[</span><span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">]]</span>

        <span class="n">sm1</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
               <span class="p">[</span><span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
               <span class="p">[</span><span class="mf">1.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
               <span class="p">[</span><span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">]]</span>

        <span class="n">sm2</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
               <span class="p">[</span><span class="mf">1.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
               <span class="p">[</span><span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
               <span class="p">[</span><span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">]]</span>

        <span class="n">assert_array_equal</span><span class="p">(</span><span class="n">spin_algebra</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">full</span><span class="p">(),</span> <span class="n">sx1</span><span class="p">)</span>
        <span class="n">assert_array_equal</span><span class="p">(</span><span class="n">spin_algebra</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">full</span><span class="p">(),</span> <span class="n">sx2</span><span class="p">)</span>
        <span class="n">assert_array_equal</span><span class="p">(</span><span class="n">spin_algebra</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">full</span><span class="p">(),</span> <span class="n">sy1</span><span class="p">)</span>
        <span class="n">assert_array_equal</span><span class="p">(</span><span class="n">spin_algebra</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">full</span><span class="p">(),</span> <span class="n">sy2</span><span class="p">)</span>
        <span class="n">assert_array_equal</span><span class="p">(</span><span class="n">spin_algebra</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">full</span><span class="p">(),</span> <span class="n">sz1</span><span class="p">)</span>
        <span class="n">assert_array_equal</span><span class="p">(</span><span class="n">spin_algebra</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">full</span><span class="p">(),</span> <span class="n">sz2</span><span class="p">)</span>
        <span class="n">assert_array_equal</span><span class="p">(</span><span class="n">spin_algebra</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">full</span><span class="p">(),</span> <span class="n">sp1</span><span class="p">)</span>
        <span class="n">assert_array_equal</span><span class="p">(</span><span class="n">spin_algebra</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">full</span><span class="p">(),</span> <span class="n">sp2</span><span class="p">)</span>
        <span class="n">assert_array_equal</span><span class="p">(</span><span class="n">spin_algebra</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">full</span><span class="p">(),</span> <span class="n">sm1</span><span class="p">)</span>
        <span class="n">assert_array_equal</span><span class="p">(</span><span class="n">spin_algebra</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">full</span><span class="p">(),</span> <span class="n">sm2</span><span class="p">)</span>

        <span class="c1"># test error</span>
        <span class="n">assert_raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">spin_algebra</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;q&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TestDicke.test_collective_algebra"><a class="viewcode-back" href="../../../piqs.tests.html#piqs.tests.test_dicke.TestDicke.test_collective_algebra">[docs]</a>    <span class="k">def</span> <span class="nf">test_collective_algebra</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Tests the generation of the collective algebra in uncoupled basis.</span>

<span class="sd">        The list [jx, jy, jz] created in the 2^N Hilbert space is</span>
<span class="sd">        checked for N = 2.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">jx_n2</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
                 <span class="p">[</span><span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
                 <span class="p">[</span><span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
                 <span class="p">[</span><span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">]]</span>

        <span class="n">jy_n2</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">-</span> <span class="mf">0.5</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">-</span> <span class="mf">0.5</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
                 <span class="p">[</span><span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.5</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">-</span> <span class="mf">0.5</span><span class="n">j</span><span class="p">],</span>
                 <span class="p">[</span><span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.5</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">-</span> <span class="mf">0.5</span><span class="n">j</span><span class="p">],</span>
                 <span class="p">[</span><span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.5</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.5</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">]]</span>

        <span class="n">jz_n2</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">1.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
                 <span class="p">[</span><span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
                 <span class="p">[</span><span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
                 <span class="p">[</span><span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">]]</span>

        <span class="n">jp_n2</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
                 <span class="p">[</span><span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
                 <span class="p">[</span><span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
                 <span class="p">[</span><span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">]]</span>

        <span class="n">jm_n2</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
                 <span class="p">[</span><span class="mf">1.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
                 <span class="p">[</span><span class="mf">1.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
                 <span class="p">[</span><span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">]]</span>

        <span class="n">assert_array_equal</span><span class="p">(</span><span class="n">jspin</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s2">&quot;uncoupled&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">full</span><span class="p">(),</span> <span class="n">jx_n2</span><span class="p">)</span>
        <span class="n">assert_array_equal</span><span class="p">(</span><span class="n">jspin</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s2">&quot;uncoupled&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">full</span><span class="p">(),</span> <span class="n">jy_n2</span><span class="p">)</span>
        <span class="n">assert_array_equal</span><span class="p">(</span><span class="n">jspin</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s2">&quot;uncoupled&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">full</span><span class="p">(),</span> <span class="n">jz_n2</span><span class="p">)</span>
        <span class="n">assert_array_equal</span><span class="p">(</span><span class="n">jspin</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s2">&quot;uncoupled&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">full</span><span class="p">(),</span> <span class="n">jp_n2</span><span class="p">)</span>
        <span class="n">assert_array_equal</span><span class="p">(</span><span class="n">jspin</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s2">&quot;uncoupled&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">full</span><span class="p">(),</span> <span class="n">jm_n2</span><span class="p">)</span>

        <span class="c1"># error</span>
        <span class="n">assert_raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">spin_algebra</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;q&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TestDicke.test_block_matrix"><a class="viewcode-back" href="../../../piqs.tests.html#piqs.tests.test_dicke.TestDicke.test_block_matrix">[docs]</a>    <span class="k">def</span> <span class="nf">test_block_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Tests the calculation of the block-diagonal matrix for given N.</span>
<span class="sd">        </span>
<span class="sd">        If the matrix element |j,m&gt;&lt;j,m&#39;| is allowed it is 1, otherwise 0.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># N = 1 TLSs</span>
        <span class="n">block_1</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]]</span>

        <span class="c1"># N = 2 TLSs</span>
        <span class="n">block_2</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                   <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]]</span>

        <span class="c1"># N = 3 TLSs</span>
        <span class="n">block_3</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                   <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                   <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                   <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                   <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span>
                   <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]]</span>

        <span class="n">assert_equal</span><span class="p">(</span><span class="n">Qobj</span><span class="p">(</span><span class="n">block_1</span><span class="p">),</span> <span class="n">Qobj</span><span class="p">(</span><span class="n">block_matrix</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
        <span class="n">assert_equal</span><span class="p">(</span><span class="n">Qobj</span><span class="p">(</span><span class="n">block_2</span><span class="p">),</span> <span class="n">Qobj</span><span class="p">(</span><span class="n">block_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
        <span class="n">assert_equal</span><span class="p">(</span><span class="n">Qobj</span><span class="p">(</span><span class="n">block_3</span><span class="p">),</span> <span class="n">Qobj</span><span class="p">(</span><span class="n">block_matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span></div>

<div class="viewcode-block" id="TestDicke.test_dicke_basis"><a class="viewcode-back" href="../../../piqs.tests.html#piqs.tests.test_dicke.TestDicke.test_dicke_basis">[docs]</a>    <span class="k">def</span> <span class="nf">test_dicke_basis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test if the Dicke basis (j, m, m&#39;) is constructed correctly.</span>

<span class="sd">        We test the state with for N = 2,</span>

<span class="sd">        0   0   0.3 0</span>
<span class="sd">        0   0.5 0   0</span>
<span class="sd">        0.3 0   0   0</span>
<span class="sd">        0   0   0   0.5</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">N</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">true_dicke_basis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
        <span class="n">true_dicke_basis</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>
        <span class="n">true_dicke_basis</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>
        <span class="n">true_dicke_basis</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.3</span>
        <span class="n">true_dicke_basis</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.3</span>
        <span class="n">true_dicke_basis</span> <span class="o">=</span> <span class="n">Qobj</span><span class="p">(</span><span class="n">true_dicke_basis</span><span class="p">)</span>
        <span class="n">jmm1_1</span> <span class="o">=</span> <span class="p">{(</span><span class="n">N</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="mf">0.5</span><span class="p">}</span>
        <span class="n">jmm1_2</span> <span class="o">=</span> <span class="p">{(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="mf">0.5</span><span class="p">}</span>
        <span class="n">jmm1_3</span> <span class="o">=</span> <span class="p">{(</span><span class="n">N</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">N</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">N</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">):</span> <span class="mf">0.3</span><span class="p">}</span>
        <span class="n">jmm1_4</span> <span class="o">=</span> <span class="p">{(</span><span class="n">N</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">N</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="n">N</span> <span class="o">/</span> <span class="mi">2</span><span class="p">):</span> <span class="mf">0.3</span><span class="p">}</span>
        <span class="n">db1</span> <span class="o">=</span> <span class="n">dicke_basis</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">jmm1_1</span><span class="p">)</span>
        <span class="n">db2</span> <span class="o">=</span> <span class="n">dicke_basis</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">jmm1_2</span><span class="p">)</span>
        <span class="n">db3</span> <span class="o">=</span> <span class="n">dicke_basis</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">jmm1_3</span><span class="p">)</span>
        <span class="n">db4</span> <span class="o">=</span> <span class="n">dicke_basis</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">jmm1_4</span><span class="p">)</span>
        <span class="n">test_dicke_basis</span> <span class="o">=</span> <span class="n">db1</span> <span class="o">+</span> <span class="n">db2</span> <span class="o">+</span> <span class="n">db3</span> <span class="o">+</span> <span class="n">db4</span>
        <span class="n">assert_equal</span><span class="p">(</span><span class="n">test_dicke_basis</span><span class="p">,</span> <span class="n">true_dicke_basis</span><span class="p">)</span>

        <span class="c1"># error</span>
        <span class="n">assert_raises</span><span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="n">dicke_basis</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span></div>

<div class="viewcode-block" id="TestDicke.test_dicke"><a class="viewcode-back" href="../../../piqs.tests.html#piqs.tests.test_dicke.TestDicke.test_dicke">[docs]</a>    <span class="k">def</span> <span class="nf">test_dicke</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test the calculation of the Dicke state as a pure state.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">true_excited</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
        <span class="n">true_excited</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="n">true_superradiant</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
        <span class="n">true_superradiant</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="n">true_subradiant</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
        <span class="n">true_subradiant</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="n">test_excited</span> <span class="o">=</span> <span class="n">dicke</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">test_superradiant</span> <span class="o">=</span> <span class="n">dicke</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">test_subradiant</span> <span class="o">=</span> <span class="n">dicke</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="n">assert_equal</span><span class="p">(</span><span class="n">test_excited</span><span class="p">,</span> <span class="n">Qobj</span><span class="p">(</span><span class="n">true_excited</span><span class="p">))</span>
        <span class="n">assert_equal</span><span class="p">(</span><span class="n">test_superradiant</span><span class="p">,</span> <span class="n">Qobj</span><span class="p">(</span><span class="n">true_superradiant</span><span class="p">))</span>
        <span class="n">assert_equal</span><span class="p">(</span><span class="n">test_subradiant</span><span class="p">,</span> <span class="n">Qobj</span><span class="p">(</span><span class="n">true_subradiant</span><span class="p">))</span></div>

<div class="viewcode-block" id="TestDicke.test_excited"><a class="viewcode-back" href="../../../piqs.tests.html#piqs.tests.test_dicke.TestDicke.test_excited">[docs]</a>    <span class="k">def</span> <span class="nf">test_excited</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Tests the calculation of the totally excited state density matrix.</span>

<span class="sd">        The matrix has size (O(N^2), O(N^2)) in Dicke basis (&#39;dicke&#39;).</span>
<span class="sd">        The matrix has size (2^N, 2^N) in the uncoupled basis (&#39;uncoupled&#39;).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">N</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="n">true_state</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
        <span class="n">true_state</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">true_state</span> <span class="o">=</span> <span class="n">Qobj</span><span class="p">(</span><span class="n">true_state</span><span class="p">)</span>

        <span class="n">test_state</span> <span class="o">=</span> <span class="n">excited</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">assert_equal</span><span class="p">(</span><span class="n">test_state</span><span class="p">,</span> <span class="n">true_state</span><span class="p">)</span>

        <span class="n">N</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="n">true_state</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
        <span class="n">true_state</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">true_state</span> <span class="o">=</span> <span class="n">Qobj</span><span class="p">(</span><span class="n">true_state</span><span class="p">)</span>

        <span class="n">test_state</span> <span class="o">=</span> <span class="n">excited</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">assert_equal</span><span class="p">(</span><span class="n">test_state</span><span class="p">,</span> <span class="n">true_state</span><span class="p">)</span>

        <span class="c1"># uncoupled</span>
        <span class="n">test_state_uncoupled</span> <span class="o">=</span> <span class="n">excited</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s2">&quot;uncoupled&quot;</span><span class="p">)</span>
        <span class="n">assert_array_equal</span><span class="p">(</span><span class="n">test_state_uncoupled</span><span class="o">.</span><span class="n">dims</span><span class="p">,</span> <span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
        <span class="n">assert_array_equal</span><span class="p">(</span><span class="n">test_state_uncoupled</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
        <span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">test_state_uncoupled</span><span class="o">.</span><span class="n">full</span><span class="p">()[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="o">+</span><span class="mi">0</span><span class="n">j</span><span class="p">)</span></div>

<div class="viewcode-block" id="TestDicke.test_superradiant"><a class="viewcode-back" href="../../../piqs.tests.html#piqs.tests.test_dicke.TestDicke.test_superradiant">[docs]</a>    <span class="k">def</span> <span class="nf">test_superradiant</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test the calculation of the superradiant state density matrix.</span>

<span class="sd">        The state is |N/2, 0&gt; for N even and |N/2, 0.5&gt; for N odd.</span>
<span class="sd">        The matrix has size (O(N^2), O(N^2)) in Dicke basis (&#39;dicke&#39;).</span>
<span class="sd">        The matrix has size (2^N, 2^N) in the uncoupled basis (&#39;uncoupled&#39;).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">N</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="n">true_state</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
        <span class="n">true_state</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">true_state</span> <span class="o">=</span> <span class="n">Qobj</span><span class="p">(</span><span class="n">true_state</span><span class="p">)</span>
        <span class="n">test_state</span> <span class="o">=</span> <span class="n">superradiant</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">assert_equal</span><span class="p">(</span><span class="n">test_state</span><span class="p">,</span> <span class="n">true_state</span><span class="p">)</span>
        <span class="n">N</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="n">true_state</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
        <span class="n">true_state</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">true_state</span> <span class="o">=</span> <span class="n">Qobj</span><span class="p">(</span><span class="n">true_state</span><span class="p">)</span>
        <span class="n">test_state</span> <span class="o">=</span> <span class="n">superradiant</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">assert_equal</span><span class="p">(</span><span class="n">test_state</span><span class="p">,</span> <span class="n">true_state</span><span class="p">)</span>

        <span class="c1"># uncoupled</span>
        <span class="n">test_state_uncoupled</span> <span class="o">=</span> <span class="n">superradiant</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s2">&quot;uncoupled&quot;</span><span class="p">)</span>
        <span class="n">assert_array_equal</span><span class="p">(</span><span class="n">test_state_uncoupled</span><span class="o">.</span><span class="n">dims</span><span class="p">,</span> <span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
        <span class="n">assert_array_equal</span><span class="p">(</span><span class="n">test_state_uncoupled</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
        <span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">test_state_uncoupled</span><span class="o">.</span><span class="n">full</span><span class="p">()[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="o">+</span><span class="mi">0</span><span class="n">j</span><span class="p">)</span></div>

<div class="viewcode-block" id="TestDicke.test_ghz"><a class="viewcode-back" href="../../../piqs.tests.html#piqs.tests.test_dicke.TestDicke.test_ghz">[docs]</a>    <span class="k">def</span> <span class="nf">test_ghz</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test the calculation of the density matrix of the GHZ state.</span>

<span class="sd">        Test for N = 2 in the &#39;dicke&#39; and in the &#39;uncoupled&#39; basis.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ghz_dicke</span> <span class="o">=</span> <span class="n">Qobj</span><span class="p">([[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                          <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
        <span class="n">ghz_uncoupled</span> <span class="o">=</span> <span class="n">Qobj</span><span class="p">([[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]])</span>
        <span class="n">ghz_uncoupled</span><span class="o">.</span><span class="n">dims</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
        <span class="n">assert_equal</span><span class="p">(</span><span class="n">ghz</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">ghz_dicke</span><span class="p">)</span>
        <span class="n">assert_equal</span><span class="p">(</span><span class="n">ghz</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;uncoupled&quot;</span><span class="p">),</span> <span class="n">ghz_uncoupled</span><span class="p">)</span></div>

<div class="viewcode-block" id="TestDicke.test_ground"><a class="viewcode-back" href="../../../piqs.tests.html#piqs.tests.test_dicke.TestDicke.test_ground">[docs]</a>    <span class="k">def</span> <span class="nf">test_ground</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test the calculation of the density matrix of the ground state.</span>

<span class="sd">        Test for N = 2 in the &#39;dicke&#39; and in the &#39;uncoupled&#39; basis.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">zeros</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex</span><span class="p">)</span>
        <span class="n">gdicke</span> <span class="o">=</span> <span class="n">zeros</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">guncoupled</span> <span class="o">=</span> <span class="n">zeros</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">gdicke</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">guncoupled</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="n">dim_dicke</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">]]</span>
        <span class="n">dim_uncoupled</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>

        <span class="n">test_ground_dicke</span> <span class="o">=</span> <span class="n">ground</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">test_ground_uncoupled</span> <span class="o">=</span> <span class="n">ground</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;uncoupled&quot;</span><span class="p">)</span>

        <span class="n">assert_array_equal</span><span class="p">(</span><span class="n">test_ground_dicke</span><span class="o">.</span><span class="n">full</span><span class="p">(),</span> <span class="n">gdicke</span><span class="p">)</span>
        <span class="n">assert_array_equal</span><span class="p">(</span><span class="n">test_ground_dicke</span><span class="o">.</span><span class="n">dims</span><span class="p">,</span> <span class="n">dim_dicke</span><span class="p">)</span>
        <span class="n">assert_array_equal</span><span class="p">(</span><span class="n">test_ground_uncoupled</span><span class="o">.</span><span class="n">full</span><span class="p">(),</span> <span class="n">guncoupled</span><span class="p">)</span>
        <span class="n">assert_array_equal</span><span class="p">(</span><span class="n">test_ground_uncoupled</span><span class="o">.</span><span class="n">dims</span><span class="p">,</span> <span class="n">dim_uncoupled</span><span class="p">)</span></div>

<div class="viewcode-block" id="TestDicke.test_identity_uncoupled"><a class="viewcode-back" href="../../../piqs.tests.html#piqs.tests.test_dicke.TestDicke.test_identity_uncoupled">[docs]</a>    <span class="k">def</span> <span class="nf">test_identity_uncoupled</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test the calculation of the identity in a 2^N dim Hilbert space.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">test_identity</span> <span class="o">=</span> <span class="n">identity_uncoupled</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">assert_equal</span><span class="p">(</span><span class="n">test_identity</span><span class="o">.</span><span class="n">dims</span><span class="p">,</span> <span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
        <span class="n">assert_array_equal</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">test_identity</span><span class="o">.</span><span class="n">full</span><span class="p">()),</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span>
                                                                  <span class="n">np</span><span class="o">.</span><span class="n">complex</span><span class="p">))</span></div>

<div class="viewcode-block" id="TestDicke.test_css"><a class="viewcode-back" href="../../../piqs.tests.html#piqs.tests.test_dicke.TestDicke.test_css">[docs]</a>    <span class="k">def</span> <span class="nf">test_css</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test the calculation of the CSS state.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">test_css_uncoupled</span> <span class="o">=</span> <span class="n">css</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;uncoupled&#39;</span><span class="p">)</span>
        <span class="n">test_css_dicke</span> <span class="o">=</span> <span class="n">css</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">css_uncoupled</span> <span class="o">=</span> <span class="mf">0.25</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex</span><span class="p">)</span>
        <span class="n">css_dicke</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.25000000</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.35355339</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>
                               <span class="mf">0.25000000</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.00000000</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
                               <span class="p">[</span><span class="mf">0.35355339</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.50000000</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>
                               <span class="mf">0.35355339</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.00000000</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
                               <span class="p">[</span> <span class="mf">0.25000000</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.35355339</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>
                               <span class="mf">0.25000000</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.00000000</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
                               <span class="p">[</span><span class="mf">0.00000000</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.00000000</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>
                               <span class="mf">0.00000000</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.00000000</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">]])</span>
        <span class="n">assert_array_almost_equal</span><span class="p">(</span><span class="n">test_css_uncoupled</span><span class="o">.</span><span class="n">full</span><span class="p">(),</span> <span class="n">css_uncoupled</span><span class="p">)</span>
        <span class="n">assert_array_almost_equal</span><span class="p">(</span><span class="n">test_css_dicke</span><span class="o">.</span><span class="n">full</span><span class="p">(),</span> <span class="n">css_dicke</span><span class="p">)</span></div>

<div class="viewcode-block" id="TestDicke.test_collapse_uncoupled"><a class="viewcode-back" href="../../../piqs.tests.html#piqs.tests.test_dicke.TestDicke.test_collapse_uncoupled">[docs]</a>    <span class="k">def</span> <span class="nf">test_collapse_uncoupled</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test the calculation of the correct collapse operators (c_ops) list.</span>

<span class="sd">        In the &quot;uncoupled&quot; basis of N two-level system (TLS).</span>
<span class="sd">        The test is performed for N = 2 and emission = 1.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">c1</span> <span class="o">=</span> <span class="n">Qobj</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="n">dims</span><span class="o">=</span><span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
        <span class="n">c2</span> <span class="o">=</span> <span class="n">Qobj</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="n">dims</span><span class="o">=</span><span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
        <span class="n">true_c_ops</span> <span class="o">=</span> <span class="p">[</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">]</span>
        <span class="n">assert_equal</span><span class="p">(</span><span class="n">true_c_ops</span><span class="p">,</span> <span class="n">collapse_uncoupled</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">emission</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">system</span> <span class="o">=</span> <span class="n">Dicke</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">emission</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">assert_equal</span><span class="p">(</span><span class="n">true_c_ops</span><span class="p">,</span> <span class="n">system</span><span class="o">.</span><span class="n">c_ops</span><span class="p">())</span></div>

<div class="viewcode-block" id="TestDicke.test_get_blocks"><a class="viewcode-back" href="../../../piqs.tests.html#piqs.tests.test_dicke.TestDicke.test_get_blocks">[docs]</a>    <span class="k">def</span> <span class="nf">test_get_blocks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test the calculation of list of cumulative elements at each block.</span>

<span class="sd">        For N = 4</span>

<span class="sd">        1 1 1 1 1</span>
<span class="sd">        1 1 1 1 1</span>
<span class="sd">        1 1 1 1 1</span>
<span class="sd">        1 1 1 1 1</span>
<span class="sd">        1 1 1 1 1</span>
<span class="sd">                1 1 1</span>
<span class="sd">                1 1 1</span>
<span class="sd">                1 1 1</span>
<span class="sd">                     1</span>
<span class="sd">        Thus, the blocks are [5, 8, 9] denoting that after the first block 5</span>
<span class="sd">        elements have been accounted for and so on.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">trueb1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">trueb2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
        <span class="n">trueb3</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
        <span class="n">trueb4</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>

        <span class="n">test_b1</span> <span class="o">=</span> <span class="n">get_blocks</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">test_b2</span> <span class="o">=</span> <span class="n">get_blocks</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">test_b3</span> <span class="o">=</span> <span class="n">get_blocks</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">test_b4</span> <span class="o">=</span> <span class="n">get_blocks</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

        <span class="n">assert_equal</span><span class="p">(</span><span class="n">test_b1</span><span class="p">,</span> <span class="n">trueb1</span><span class="p">)</span>
        <span class="n">assert_equal</span><span class="p">(</span><span class="n">test_b2</span><span class="p">,</span> <span class="n">trueb2</span><span class="p">)</span>
        <span class="n">assert_equal</span><span class="p">(</span><span class="n">test_b3</span><span class="p">,</span> <span class="n">trueb3</span><span class="p">)</span></div>

<div class="viewcode-block" id="TestDicke.test_lindbladian_dims"><a class="viewcode-back" href="../../../piqs.tests.html#piqs.tests.test_dicke.TestDicke.test_lindbladian_dims">[docs]</a>    <span class="k">def</span> <span class="nf">test_lindbladian_dims</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test the calculation of the lindbladian matrix.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">true_L</span> <span class="o">=</span> <span class="p">[[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.54999995</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.54999995</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">]]</span>
        <span class="n">true_L</span> <span class="o">=</span> <span class="n">Qobj</span><span class="p">(</span><span class="n">true_L</span><span class="p">)</span>
        <span class="n">true_L</span><span class="o">.</span><span class="n">dims</span> <span class="o">=</span> <span class="p">[[[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">]]]</span>
        <span class="n">N</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">test_dicke</span> <span class="o">=</span> <span class="n">_Dicke</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">pumping</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">collective_pumping</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                            <span class="n">emission</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">collective_emission</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                            <span class="n">dephasing</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="n">test_L</span> <span class="o">=</span> <span class="n">test_dicke</span><span class="o">.</span><span class="n">lindbladian</span><span class="p">()</span>
        <span class="n">assert_array_almost_equal</span><span class="p">(</span><span class="n">test_L</span><span class="o">.</span><span class="n">full</span><span class="p">(),</span> <span class="n">true_L</span><span class="o">.</span><span class="n">full</span><span class="p">())</span>
        <span class="n">assert_array_equal</span><span class="p">(</span><span class="n">test_L</span><span class="o">.</span><span class="n">dims</span><span class="p">,</span> <span class="n">true_L</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span></div>

<div class="viewcode-block" id="TestDicke.test_liouvillian"><a class="viewcode-back" href="../../../piqs.tests.html#piqs.tests.test_dicke.TestDicke.test_liouvillian">[docs]</a>    <span class="k">def</span> <span class="nf">test_liouvillian</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test the calculation of the liouvillian matrix.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">true_L</span> <span class="o">=</span> <span class="p">[[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.54999995</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.54999995</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">]]</span>
        <span class="n">true_L</span> <span class="o">=</span> <span class="n">Qobj</span><span class="p">(</span><span class="n">true_L</span><span class="p">)</span>
        <span class="n">true_L</span><span class="o">.</span><span class="n">dims</span> <span class="o">=</span> <span class="p">[[[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">]]]</span>
        <span class="n">true_H</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">1.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span> <span class="o">+</span> <span class="mf">0.</span><span class="n">j</span><span class="p">]]</span>
        <span class="n">true_H</span> <span class="o">=</span> <span class="n">Qobj</span><span class="p">(</span><span class="n">true_H</span><span class="p">)</span>
        <span class="n">true_H</span><span class="o">.</span><span class="n">dims</span> <span class="o">=</span> <span class="p">[[[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">]]]</span>
        <span class="n">true_liouvillian</span> <span class="o">=</span> <span class="p">[[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="n">j</span><span class="p">,</span> <span class="mf">1.</span><span class="n">j</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
                            <span class="p">[</span><span class="o">-</span><span class="mf">1.</span><span class="n">j</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.54999995</span> <span class="o">+</span> <span class="mf">2.</span><span class="n">j</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.</span><span class="n">j</span><span class="p">],</span>
                            <span class="p">[</span><span class="mf">1.</span><span class="n">j</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.54999995</span> <span class="o">-</span> <span class="mf">2.</span><span class="n">j</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="n">j</span><span class="p">],</span>
                            <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="o">+</span><span class="mf">1.</span><span class="n">j</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="n">j</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">]]</span>
        <span class="n">true_liouvillian</span> <span class="o">=</span> <span class="n">Qobj</span><span class="p">(</span><span class="n">true_liouvillian</span><span class="p">)</span>
        <span class="n">true_liouvillian</span><span class="o">.</span><span class="n">dims</span> <span class="o">=</span> <span class="p">[[[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">]]]</span>
        <span class="n">N</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">test_piqs</span> <span class="o">=</span> <span class="n">Dicke</span><span class="p">(</span><span class="n">hamiltonian</span><span class="o">=</span><span class="n">sigmaz</span><span class="p">()</span> <span class="o">+</span> <span class="n">sigmax</span><span class="p">(),</span> <span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">,</span>
                          <span class="n">pumping</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">collective_pumping</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">emission</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                          <span class="n">collective_emission</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">dephasing</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="n">test_liouvillian</span> <span class="o">=</span> <span class="n">test_piqs</span><span class="o">.</span><span class="n">liouvillian</span><span class="p">()</span>
        <span class="n">test_hamiltonian</span> <span class="o">=</span> <span class="n">test_piqs</span><span class="o">.</span><span class="n">hamiltonian</span>
        <span class="n">assert_array_almost_equal</span><span class="p">(</span>
            <span class="n">test_liouvillian</span><span class="o">.</span><span class="n">full</span><span class="p">(),</span>
            <span class="n">true_liouvillian</span><span class="o">.</span><span class="n">full</span><span class="p">())</span>
        <span class="n">assert_array_almost_equal</span><span class="p">(</span><span class="n">test_hamiltonian</span><span class="o">.</span><span class="n">full</span><span class="p">(),</span> <span class="n">true_H</span><span class="o">.</span><span class="n">full</span><span class="p">())</span>
        <span class="n">assert_array_equal</span><span class="p">(</span><span class="n">test_liouvillian</span><span class="o">.</span><span class="n">dims</span><span class="p">,</span> <span class="n">test_liouvillian</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span>

        <span class="c1"># no Hamiltonian</span>
        <span class="n">test_piqs</span> <span class="o">=</span> <span class="n">Dicke</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">,</span>
                          <span class="n">pumping</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">collective_pumping</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">emission</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                          <span class="n">collective_emission</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">dephasing</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="n">liouv</span> <span class="o">=</span> <span class="n">test_piqs</span><span class="o">.</span><span class="n">liouvillian</span><span class="p">()</span>
        <span class="n">lindblad</span> <span class="o">=</span> <span class="n">test_piqs</span><span class="o">.</span><span class="n">lindbladian</span><span class="p">()</span>
        <span class="n">assert_equal</span><span class="p">(</span><span class="n">liouv</span><span class="p">,</span> <span class="n">lindblad</span><span class="p">)</span></div>

<div class="viewcode-block" id="TestDicke.test_gamma1"><a class="viewcode-back" href="../../../piqs.tests.html#piqs.tests.test_dicke.TestDicke.test_gamma1">[docs]</a>    <span class="k">def</span> <span class="nf">test_gamma1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test the calculation of gamma1.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">true_gamma_1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
        <span class="n">true_gamma_2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span>
        <span class="n">true_gamma_3</span> <span class="o">=</span> <span class="o">-</span><span class="mi">7</span>
        <span class="n">true_gamma_4</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">true_gamma_5</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">true_gamma_6</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">N</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="n">test_dicke</span> <span class="o">=</span> <span class="n">_Dicke</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">collective_emission</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">test_gamma_1</span> <span class="o">=</span> <span class="n">test_dicke</span><span class="o">.</span><span class="n">gamma1</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">test_dicke</span> <span class="o">=</span> <span class="n">_Dicke</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">emission</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">test_gamma_2</span> <span class="o">=</span> <span class="n">test_dicke</span><span class="o">.</span><span class="n">gamma1</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">test_dicke</span> <span class="o">=</span> <span class="n">_Dicke</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">emission</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">collective_emission</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">test_gamma_3</span> <span class="o">=</span> <span class="n">test_dicke</span><span class="o">.</span><span class="n">gamma1</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">test_dicke</span> <span class="o">=</span> <span class="n">_Dicke</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">dephasing</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">test_gamma_4</span> <span class="o">=</span> <span class="n">test_dicke</span><span class="o">.</span><span class="n">gamma1</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">test_dicke</span> <span class="o">=</span> <span class="n">_Dicke</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">collective_pumping</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">test_gamma_5</span> <span class="o">=</span> <span class="n">test_dicke</span><span class="o">.</span><span class="n">gamma1</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">test_dicke</span> <span class="o">=</span> <span class="n">_Dicke</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">collective_dephasing</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">test_gamma_6</span> <span class="o">=</span> <span class="n">test_dicke</span><span class="o">.</span><span class="n">gamma1</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

        <span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">true_gamma_1</span><span class="p">,</span> <span class="n">test_gamma_1</span><span class="p">)</span>
        <span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">true_gamma_2</span><span class="p">,</span> <span class="n">test_gamma_2</span><span class="p">)</span>
        <span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">true_gamma_3</span><span class="p">,</span> <span class="n">test_gamma_3</span><span class="p">)</span>
        <span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">true_gamma_4</span><span class="p">,</span> <span class="n">test_gamma_4</span><span class="p">)</span>
        <span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">true_gamma_5</span><span class="p">,</span> <span class="n">test_gamma_5</span><span class="p">)</span>
        <span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">true_gamma_6</span><span class="p">,</span> <span class="n">test_gamma_6</span><span class="p">)</span></div>

<div class="viewcode-block" id="TestDicke.test_gamma2"><a class="viewcode-back" href="../../../piqs.tests.html#piqs.tests.test_dicke.TestDicke.test_gamma2">[docs]</a>    <span class="k">def</span> <span class="nf">test_gamma2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test the calculation of gamma2. Test performed for N = 4.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">true_gamma_1</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">true_gamma_2</span> <span class="o">=</span> <span class="mf">1.5</span>
        <span class="n">true_gamma_3</span> <span class="o">=</span> <span class="mf">5.5</span>
        <span class="n">true_gamma_4</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">true_gamma_5</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">true_gamma_6</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">N</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="n">test_dicke</span> <span class="o">=</span> <span class="n">_Dicke</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">collective_emission</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">test_gamma_1</span> <span class="o">=</span> <span class="n">test_dicke</span><span class="o">.</span><span class="n">gamma2</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">test_dicke</span> <span class="o">=</span> <span class="n">_Dicke</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">emission</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">test_gamma_2</span> <span class="o">=</span> <span class="n">test_dicke</span><span class="o">.</span><span class="n">gamma2</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">test_dicke</span> <span class="o">=</span> <span class="n">_Dicke</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">emission</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">collective_emission</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">test_gamma_3</span> <span class="o">=</span> <span class="n">test_dicke</span><span class="o">.</span><span class="n">gamma2</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">test_dicke</span> <span class="o">=</span> <span class="n">_Dicke</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">dephasing</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">test_gamma_4</span> <span class="o">=</span> <span class="n">test_dicke</span><span class="o">.</span><span class="n">gamma2</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">test_dicke</span> <span class="o">=</span> <span class="n">_Dicke</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">collective_pumping</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">test_gamma_5</span> <span class="o">=</span> <span class="n">test_dicke</span><span class="o">.</span><span class="n">gamma2</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">test_dicke</span> <span class="o">=</span> <span class="n">_Dicke</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">collective_dephasing</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">test_gamma_6</span> <span class="o">=</span> <span class="n">test_dicke</span><span class="o">.</span><span class="n">gamma2</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

        <span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">true_gamma_1</span><span class="p">,</span> <span class="n">test_gamma_1</span><span class="p">)</span>
        <span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">true_gamma_2</span><span class="p">,</span> <span class="n">test_gamma_2</span><span class="p">)</span>
        <span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">true_gamma_3</span><span class="p">,</span> <span class="n">test_gamma_3</span><span class="p">)</span>
        <span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">true_gamma_4</span><span class="p">,</span> <span class="n">test_gamma_4</span><span class="p">)</span>
        <span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">true_gamma_5</span><span class="p">,</span> <span class="n">test_gamma_5</span><span class="p">)</span>
        <span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">true_gamma_6</span><span class="p">,</span> <span class="n">test_gamma_6</span><span class="p">)</span></div>

<div class="viewcode-block" id="TestDicke.test_gamma3"><a class="viewcode-back" href="../../../piqs.tests.html#piqs.tests.test_dicke.TestDicke.test_gamma3">[docs]</a>    <span class="k">def</span> <span class="nf">test_gamma3</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test the calculation of gamma3. Test performed for N = 4.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">true_gamma_1</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">true_gamma_2</span> <span class="o">=</span> <span class="mf">1.3333333730697632</span>
        <span class="n">true_gamma_3</span> <span class="o">=</span> <span class="mf">1.3333333730697632</span>
        <span class="n">true_gamma_4</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">true_gamma_5</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">true_gamma_6</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">N</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="n">test_dicke</span> <span class="o">=</span> <span class="n">_Dicke</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">collective_emission</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">test_gamma_1</span> <span class="o">=</span> <span class="n">test_dicke</span><span class="o">.</span><span class="n">gamma3</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">test_dicke</span> <span class="o">=</span> <span class="n">_Dicke</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">emission</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">test_gamma_2</span> <span class="o">=</span> <span class="n">test_dicke</span><span class="o">.</span><span class="n">gamma3</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">test_dicke</span> <span class="o">=</span> <span class="n">_Dicke</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">emission</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">collective_emission</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">test_gamma_3</span> <span class="o">=</span> <span class="n">test_dicke</span><span class="o">.</span><span class="n">gamma3</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">test_dicke</span> <span class="o">=</span> <span class="n">_Dicke</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">dephasing</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">test_gamma_4</span> <span class="o">=</span> <span class="n">test_dicke</span><span class="o">.</span><span class="n">gamma3</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">test_dicke</span> <span class="o">=</span> <span class="n">_Dicke</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">collective_pumping</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">test_gamma_5</span> <span class="o">=</span> <span class="n">test_dicke</span><span class="o">.</span><span class="n">gamma3</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">test_dicke</span> <span class="o">=</span> <span class="n">_Dicke</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">collective_dephasing</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">test_gamma_6</span> <span class="o">=</span> <span class="n">test_dicke</span><span class="o">.</span><span class="n">gamma3</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="c1">#</span>
        <span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">true_gamma_1</span><span class="p">,</span> <span class="n">test_gamma_1</span><span class="p">)</span>
        <span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">true_gamma_2</span><span class="p">,</span> <span class="n">test_gamma_2</span><span class="p">)</span>
        <span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">true_gamma_3</span><span class="p">,</span> <span class="n">test_gamma_3</span><span class="p">)</span>
        <span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">true_gamma_4</span><span class="p">,</span> <span class="n">test_gamma_4</span><span class="p">)</span>
        <span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">true_gamma_5</span><span class="p">,</span> <span class="n">test_gamma_5</span><span class="p">)</span>
        <span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">true_gamma_6</span><span class="p">,</span> <span class="n">test_gamma_6</span><span class="p">)</span></div>

<div class="viewcode-block" id="TestDicke.test_gamma4"><a class="viewcode-back" href="../../../piqs.tests.html#piqs.tests.test_dicke.TestDicke.test_gamma4">[docs]</a>    <span class="k">def</span> <span class="nf">test_gamma4</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test the calculation of gamma4. Test performed for N = 4.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">true_gamma_1</span> <span class="o">=</span> <span class="mf">0.1666666716337204</span>
        <span class="n">true_gamma_2</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">true_gamma_3</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">true_gamma_4</span> <span class="o">=</span> <span class="mf">0.40824830532073975</span>

        <span class="n">N</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="n">test_dicke</span> <span class="o">=</span> <span class="n">_Dicke</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">emission</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">collective_emission</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">test_gamma_1</span> <span class="o">=</span> <span class="n">test_dicke</span><span class="o">.</span><span class="n">gamma4</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">test_gamma_2</span> <span class="o">=</span> <span class="n">test_dicke</span><span class="o">.</span><span class="n">gamma4</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="n">test_gamma_3</span> <span class="o">=</span> <span class="n">test_dicke</span><span class="o">.</span><span class="n">gamma4</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">test_gamma_4</span> <span class="o">=</span> <span class="n">test_dicke</span><span class="o">.</span><span class="n">gamma4</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

        <span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">true_gamma_1</span><span class="p">,</span> <span class="n">test_gamma_1</span><span class="p">)</span>
        <span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">true_gamma_2</span><span class="p">,</span> <span class="n">test_gamma_2</span><span class="p">)</span>
        <span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">true_gamma_3</span><span class="p">,</span> <span class="n">test_gamma_3</span><span class="p">)</span>
        <span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">true_gamma_4</span><span class="p">,</span> <span class="n">test_gamma_4</span><span class="p">)</span></div>

<div class="viewcode-block" id="TestDicke.test_gamma5"><a class="viewcode-back" href="../../../piqs.tests.html#piqs.tests.test_dicke.TestDicke.test_gamma5">[docs]</a>    <span class="k">def</span> <span class="nf">test_gamma5</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test the calculation of gamma5. Test performed for N = 4.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">true_gamma_1</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">true_gamma_2</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">true_gamma_3</span> <span class="o">=</span> <span class="mf">0.75</span>
        <span class="n">true_gamma_4</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">N</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="n">test_dicke</span> <span class="o">=</span> <span class="n">_Dicke</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">dephasing</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">test_gamma_1</span> <span class="o">=</span> <span class="n">test_dicke</span><span class="o">.</span><span class="n">gamma5</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">test_gamma_2</span> <span class="o">=</span> <span class="n">test_dicke</span><span class="o">.</span><span class="n">gamma5</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="n">test_gamma_3</span> <span class="o">=</span> <span class="n">test_dicke</span><span class="o">.</span><span class="n">gamma5</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">test_gamma_4</span> <span class="o">=</span> <span class="n">test_dicke</span><span class="o">.</span><span class="n">gamma5</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

        <span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">true_gamma_1</span><span class="p">,</span> <span class="n">test_gamma_1</span><span class="p">)</span>
        <span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">true_gamma_2</span><span class="p">,</span> <span class="n">test_gamma_2</span><span class="p">)</span>
        <span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">true_gamma_3</span><span class="p">,</span> <span class="n">test_gamma_3</span><span class="p">)</span>
        <span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">true_gamma_4</span><span class="p">,</span> <span class="n">test_gamma_4</span><span class="p">)</span></div>

<div class="viewcode-block" id="TestDicke.test_gamma6"><a class="viewcode-back" href="../../../piqs.tests.html#piqs.tests.test_dicke.TestDicke.test_gamma6">[docs]</a>    <span class="k">def</span> <span class="nf">test_gamma6</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test the calculation of gamma6. Test performed for N = 4.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">true_gamma_1</span> <span class="o">=</span> <span class="mf">0.25</span>
        <span class="n">true_gamma_2</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">true_gamma_3</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">true_gamma_4</span> <span class="o">=</span> <span class="mf">0.25</span>

        <span class="n">N</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="n">test_dicke</span> <span class="o">=</span> <span class="n">_Dicke</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">dephasing</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">test_gamma_1</span> <span class="o">=</span> <span class="n">test_dicke</span><span class="o">.</span><span class="n">gamma6</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">test_gamma_2</span> <span class="o">=</span> <span class="n">test_dicke</span><span class="o">.</span><span class="n">gamma6</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="n">test_gamma_3</span> <span class="o">=</span> <span class="n">test_dicke</span><span class="o">.</span><span class="n">gamma6</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">test_gamma_4</span> <span class="o">=</span> <span class="n">test_dicke</span><span class="o">.</span><span class="n">gamma6</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

        <span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">true_gamma_1</span><span class="p">,</span> <span class="n">test_gamma_1</span><span class="p">)</span>
        <span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">true_gamma_2</span><span class="p">,</span> <span class="n">test_gamma_2</span><span class="p">)</span>
        <span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">true_gamma_3</span><span class="p">,</span> <span class="n">test_gamma_3</span><span class="p">)</span>
        <span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">true_gamma_4</span><span class="p">,</span> <span class="n">test_gamma_4</span><span class="p">)</span></div>

<div class="viewcode-block" id="TestDicke.test_gamma7"><a class="viewcode-back" href="../../../piqs.tests.html#piqs.tests.test_dicke.TestDicke.test_gamma7">[docs]</a>    <span class="k">def</span> <span class="nf">test_gamma7</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test the calculation of gamma7. Test performed for N = 4.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">true_gamma_1</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">true_gamma_2</span> <span class="o">=</span> <span class="mf">0.5</span>
        <span class="n">true_gamma_3</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">true_gamma_4</span> <span class="o">=</span> <span class="mf">1.5</span>

        <span class="n">N</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="n">test_dicke</span> <span class="o">=</span> <span class="n">_Dicke</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">pumping</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">test_gamma_1</span> <span class="o">=</span> <span class="n">test_dicke</span><span class="o">.</span><span class="n">gamma7</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">test_gamma_2</span> <span class="o">=</span> <span class="n">test_dicke</span><span class="o">.</span><span class="n">gamma7</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="n">test_gamma_3</span> <span class="o">=</span> <span class="n">test_dicke</span><span class="o">.</span><span class="n">gamma7</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="n">test_gamma_4</span> <span class="o">=</span> <span class="n">test_dicke</span><span class="o">.</span><span class="n">gamma7</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>

        <span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">true_gamma_1</span><span class="p">,</span> <span class="n">test_gamma_1</span><span class="p">)</span>
        <span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">true_gamma_2</span><span class="p">,</span> <span class="n">test_gamma_2</span><span class="p">)</span>
        <span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">true_gamma_3</span><span class="p">,</span> <span class="n">test_gamma_3</span><span class="p">)</span>
        <span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">true_gamma_4</span><span class="p">,</span> <span class="n">test_gamma_4</span><span class="p">)</span></div>

<div class="viewcode-block" id="TestDicke.test_gamma8"><a class="viewcode-back" href="../../../piqs.tests.html#piqs.tests.test_dicke.TestDicke.test_gamma8">[docs]</a>    <span class="k">def</span> <span class="nf">test_gamma8</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test the calculation of gamma8. Test performed for N = 4.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">true_gamma_1</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">true_gamma_2</span> <span class="o">=</span> <span class="mf">13.5</span>
        <span class="n">true_gamma_3</span> <span class="o">=</span> <span class="mf">5.5</span>
        <span class="n">true_gamma_4</span> <span class="o">=</span> <span class="mf">13.5</span>

        <span class="n">N</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="n">test_dicke</span> <span class="o">=</span> <span class="n">_Dicke</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">pumping</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">collective_pumping</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">test_gamma_1</span> <span class="o">=</span> <span class="n">test_dicke</span><span class="o">.</span><span class="n">gamma8</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">test_gamma_2</span> <span class="o">=</span> <span class="n">test_dicke</span><span class="o">.</span><span class="n">gamma8</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="n">test_gamma_3</span> <span class="o">=</span> <span class="n">test_dicke</span><span class="o">.</span><span class="n">gamma8</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="n">test_gamma_4</span> <span class="o">=</span> <span class="n">test_dicke</span><span class="o">.</span><span class="n">gamma8</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>

        <span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">true_gamma_1</span><span class="p">,</span> <span class="n">test_gamma_1</span><span class="p">)</span>
        <span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">true_gamma_2</span><span class="p">,</span> <span class="n">test_gamma_2</span><span class="p">)</span>
        <span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">true_gamma_3</span><span class="p">,</span> <span class="n">test_gamma_3</span><span class="p">)</span>
        <span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">true_gamma_4</span><span class="p">,</span> <span class="n">test_gamma_4</span><span class="p">)</span></div>

<div class="viewcode-block" id="TestDicke.test_gamma9"><a class="viewcode-back" href="../../../piqs.tests.html#piqs.tests.test_dicke.TestDicke.test_gamma9">[docs]</a>    <span class="k">def</span> <span class="nf">test_gamma9</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test the calculation of gamma9. Test performed for N = 4.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">true_gamma_1</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">true_gamma_2</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">true_gamma_3</span> <span class="o">=</span> <span class="mf">0.5</span>
        <span class="n">true_gamma_4</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">N</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="n">test_dicke</span> <span class="o">=</span> <span class="n">_Dicke</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">pumping</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">collective_pumping</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">test_gamma_1</span> <span class="o">=</span> <span class="n">test_dicke</span><span class="o">.</span><span class="n">gamma9</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">test_gamma_2</span> <span class="o">=</span> <span class="n">test_dicke</span><span class="o">.</span><span class="n">gamma9</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="n">test_gamma_3</span> <span class="o">=</span> <span class="n">test_dicke</span><span class="o">.</span><span class="n">gamma9</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="n">test_gamma_4</span> <span class="o">=</span> <span class="n">test_dicke</span><span class="o">.</span><span class="n">gamma9</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">true_gamma_1</span><span class="p">,</span> <span class="n">test_gamma_1</span><span class="p">)</span>
        <span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">true_gamma_2</span><span class="p">,</span> <span class="n">test_gamma_2</span><span class="p">)</span>
        <span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">true_gamma_3</span><span class="p">,</span> <span class="n">test_gamma_3</span><span class="p">)</span>
        <span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">true_gamma_4</span><span class="p">,</span> <span class="n">test_gamma_4</span><span class="p">)</span></div>

<div class="viewcode-block" id="TestDicke.test_prune_eigenstates"><a class="viewcode-back" href="../../../piqs.tests.html#piqs.tests.test_dicke.TestDicke.test_prune_eigenstates">[docs]</a>    <span class="k">def</span> <span class="nf">test_prune_eigenstates</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test the eigenstate pruning</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">N</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">w0</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">kappa</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">w0</span>
        <span class="n">gCE</span> <span class="o">=</span> <span class="n">kappa</span> <span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">gE</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">gD</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="p">[</span><span class="n">jx</span><span class="p">,</span> <span class="n">jy</span><span class="p">,</span> <span class="n">jz</span><span class="p">]</span> <span class="o">=</span> <span class="n">jspin</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">jp</span><span class="p">,</span> <span class="n">jm</span> <span class="o">=</span> <span class="n">jspin</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="p">),</span> <span class="n">jspin</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span>
        <span class="n">H</span> <span class="o">=</span> <span class="n">w0</span> <span class="o">*</span> <span class="n">jx</span>

        <span class="n">ensemble</span> <span class="o">=</span> <span class="n">Dicke</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">hamiltonian</span><span class="o">=</span><span class="n">H</span><span class="p">,</span> <span class="n">collective_emission</span><span class="o">=</span><span class="n">gCE</span><span class="p">,</span>
                         <span class="n">emission</span><span class="o">=</span><span class="n">gE</span><span class="p">,</span> <span class="n">dephasing</span><span class="o">=</span><span class="n">gD</span><span class="p">)</span>
        <span class="n">liouv</span> <span class="o">=</span> <span class="n">ensemble</span><span class="o">.</span><span class="n">liouvillian</span><span class="p">()</span> 
        <span class="n">pruned_eig_values</span><span class="p">,</span> <span class="n">pruned_eig_states</span> <span class="o">=</span> <span class="n">ensemble</span><span class="o">.</span><span class="n">prune_eigenstates</span><span class="p">(</span><span class="n">liouv</span><span class="p">)</span>
        <span class="n">estate_last</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">0.00510544</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
                                <span class="p">[</span><span class="mf">0.00000000</span><span class="o">-</span><span class="mf">0.01614514</span><span class="n">j</span><span class="p">],</span>
                                <span class="p">[</span><span class="mf">0.08133350</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
                                <span class="p">[</span><span class="mf">0.00000000</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
                                <span class="p">[</span><span class="mf">0.00000000</span><span class="o">+</span><span class="mf">0.01614514</span><span class="n">j</span><span class="p">],</span>
                                <span class="p">[</span><span class="o">-</span><span class="mf">0.02588476</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
                                <span class="p">[</span><span class="mf">0.00000000</span><span class="o">-</span><span class="mf">0.30050737</span><span class="n">j</span><span class="p">],</span>
                                <span class="p">[</span><span class="mf">0.00000000</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
                                <span class="p">[</span><span class="mf">0.08133350</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
                                <span class="p">[</span><span class="mf">0.00000000</span><span class="o">+</span><span class="mf">0.30050737</span><span class="n">j</span><span class="p">],</span>
                                <span class="p">[</span><span class="o">-</span><span class="mf">0.61872203</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
                                <span class="p">[</span><span class="mf">0.00000000</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
                                <span class="p">[</span><span class="mf">0.00000000</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
                                <span class="p">[</span><span class="mf">0.00000000</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
                                <span class="p">[</span><span class="mf">0.00000000</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
                                <span class="p">[</span><span class="mf">0.64971224</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">]])</span>
        <span class="n">assert_array_almost_equal</span><span class="p">(</span><span class="n">pruned_eig_states</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">full</span><span class="p">(),</span> <span class="n">estate_last</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="TestPim"><a class="viewcode-back" href="../../../piqs.tests.html#piqs.tests.test_dicke.TestPim">[docs]</a><span class="k">class</span> <span class="nc">TestPim</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A test class for the Permutation invariance matrix generation</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="TestPim.test_gamma"><a class="viewcode-back" href="../../../piqs.tests.html#piqs.tests.test_dicke.TestPim.test_gamma">[docs]</a>    <span class="k">def</span> <span class="nf">test_gamma</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test the calculation of various gamma values for diagonal system.</span>

<span class="sd">        For N = 6 |j, m&gt; would be :</span>

<span class="sd">        | 3, 3&gt;</span>
<span class="sd">        | 3, 2&gt; | 2, 2&gt;</span>
<span class="sd">        | 3, 1&gt; | 2, 1&gt; | 1, 1&gt;</span>
<span class="sd">        | 3, 0&gt; | 2, 0&gt; | 1, 0&gt; |0, 0&gt;</span>
<span class="sd">        | 3,-1&gt; | 2,-1&gt; | 1,-1&gt;</span>
<span class="sd">        | 3,-2&gt; | 2,-2&gt;</span>
<span class="sd">        | 3,-3&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">N</span> <span class="o">=</span> <span class="mi">6</span>
        <span class="n">collective_emission</span> <span class="o">=</span> <span class="mf">1.</span>
        <span class="n">emission</span> <span class="o">=</span> <span class="mf">1.</span>
        <span class="n">dephasing</span> <span class="o">=</span> <span class="mf">1.</span>
        <span class="n">pumping</span> <span class="o">=</span> <span class="mf">1.</span>
        <span class="n">collective_pumping</span> <span class="o">=</span> <span class="mf">1.</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Pim</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">collective_emission</span><span class="o">=</span><span class="n">collective_emission</span><span class="p">,</span>
                       <span class="n">emission</span><span class="o">=</span><span class="n">emission</span><span class="p">,</span> <span class="n">dephasing</span><span class="o">=</span><span class="n">dephasing</span><span class="p">,</span>
                       <span class="n">pumping</span><span class="o">=</span><span class="n">pumping</span><span class="p">,</span> <span class="n">collective_pumping</span><span class="o">=</span><span class="n">collective_pumping</span><span class="p">)</span>
        <span class="n">tau_calculated</span> <span class="o">=</span> <span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">tau3</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                          <span class="n">model</span><span class="o">.</span><span class="n">tau2</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                          <span class="n">model</span><span class="o">.</span><span class="n">tau4</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                          <span class="n">model</span><span class="o">.</span><span class="n">tau5</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                          <span class="n">model</span><span class="o">.</span><span class="n">tau1</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                          <span class="n">model</span><span class="o">.</span><span class="n">tau6</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                          <span class="n">model</span><span class="o">.</span><span class="n">tau7</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
                          <span class="n">model</span><span class="o">.</span><span class="n">tau8</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
                          <span class="n">model</span><span class="o">.</span><span class="n">tau9</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)]</span>
        <span class="n">tau_real</span> <span class="o">=</span> <span class="p">[</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">8.</span><span class="p">,</span> <span class="mf">0.333333</span><span class="p">,</span>
                    <span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">19.5</span><span class="p">,</span> <span class="mf">0.666667</span><span class="p">,</span>
                    <span class="mf">2.</span><span class="p">,</span> <span class="mf">8.</span><span class="p">,</span> <span class="mf">0.333333</span><span class="p">]</span>
        <span class="n">assert_array_almost_equal</span><span class="p">(</span><span class="n">tau_calculated</span><span class="p">,</span> <span class="n">tau_real</span><span class="p">)</span></div>

<div class="viewcode-block" id="TestPim.test_isdicke"><a class="viewcode-back" href="../../../piqs.tests.html#piqs.tests.test_dicke.TestPim.test_isdicke">[docs]</a>    <span class="k">def</span> <span class="nf">test_isdicke</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Tests the `isdicke` function</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">N1</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">g0</span><span class="o">=.</span><span class="mi">01</span>
        <span class="n">nth</span><span class="o">=.</span><span class="mi">01</span>
        <span class="n">gP</span><span class="o">=</span><span class="n">g0</span><span class="o">*</span><span class="n">nth</span>
        <span class="n">gL</span><span class="o">=</span><span class="n">g0</span><span class="o">*</span><span class="p">(</span><span class="mf">0.1</span><span class="o">+</span><span class="n">nth</span><span class="p">)</span>
        <span class="n">gS</span><span class="o">=</span> <span class="mf">0.1</span>
        <span class="n">gD</span><span class="o">=</span> <span class="mf">0.1</span>

        <span class="n">pim1</span> <span class="o">=</span> <span class="n">Pim</span><span class="p">(</span><span class="n">N1</span><span class="p">,</span> <span class="n">gS</span><span class="p">,</span> <span class="n">gL</span><span class="p">,</span> <span class="n">gD</span><span class="p">,</span> <span class="n">gP</span><span class="p">)</span>

        <span class="n">test_indices1</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)]</span>
        <span class="n">dicke_labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">pim1</span><span class="o">.</span><span class="n">isdicke</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">test_indices1</span><span class="p">]</span>

        <span class="n">N2</span> <span class="o">=</span> <span class="mi">4</span>
        
        <span class="n">pim2</span> <span class="o">=</span> <span class="n">Pim</span><span class="p">(</span><span class="n">N2</span><span class="p">,</span> <span class="n">gS</span><span class="p">,</span> <span class="n">gL</span><span class="p">,</span> <span class="n">gD</span><span class="p">,</span> <span class="n">gP</span><span class="p">)</span>
        <span class="n">test_indices2</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]</span>
        <span class="n">dicke_labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">pim2</span><span class="o">.</span><span class="n">isdicke</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">test_indices2</span><span class="p">]</span>

        <span class="n">assert_array_equal</span><span class="p">(</span><span class="n">dicke_labels</span><span class="p">,</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span></div>

<div class="viewcode-block" id="TestPim.test_isdiagonal"><a class="viewcode-back" href="../../../piqs.tests.html#piqs.tests.test_dicke.TestPim.test_isdiagonal">[docs]</a>    <span class="k">def</span> <span class="nf">test_isdiagonal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test the isdiagonal function.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">mat1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
        <span class="n">mat2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
        <span class="n">mat3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="o">-</span><span class="mi">2</span><span class="n">j</span><span class="p">,</span> <span class="mi">2</span><span class="o">-</span><span class="mi">2</span><span class="n">j</span><span class="p">]])</span>
        <span class="n">mat4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mi">2</span><span class="o">-</span><span class="mi">2</span><span class="n">j</span><span class="p">]])</span>

        <span class="n">assert_equal</span><span class="p">(</span><span class="n">isdiagonal</span><span class="p">(</span><span class="n">mat1</span><span class="p">),</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">assert_equal</span><span class="p">(</span><span class="n">isdiagonal</span><span class="p">(</span><span class="n">mat2</span><span class="p">),</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">assert_equal</span><span class="p">(</span><span class="n">isdiagonal</span><span class="p">(</span><span class="n">mat3</span><span class="p">),</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">assert_equal</span><span class="p">(</span><span class="n">isdiagonal</span><span class="p">(</span><span class="n">mat4</span><span class="p">),</span> <span class="kc">True</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">test_pisolve</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test the warning for diagonal Hamiltonians to use internal solver</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">jx</span><span class="p">,</span> <span class="n">jy</span><span class="p">,</span> <span class="n">jz</span> <span class="o">=</span> <span class="n">jspin</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">jp</span><span class="p">,</span> <span class="n">jm</span> <span class="o">=</span> <span class="n">jspin</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="p">),</span> <span class="n">jspin</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="TestPim.test_coefficient_matrix"><a class="viewcode-back" href="../../../piqs.tests.html#piqs.tests.test_dicke.TestPim.test_coefficient_matrix">[docs]</a>    <span class="k">def</span> <span class="nf">test_coefficient_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test the coefficient matrix used by &#39;pisolve&#39; for diagonal problems.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">N</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">ensemble</span> <span class="o">=</span> <span class="n">Pim</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">emission</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">test_matrix</span> <span class="o">=</span> <span class="n">ensemble</span><span class="o">.</span><span class="n">coefficient_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">todense</span><span class="p">()</span>
        <span class="n">ensemble2</span> <span class="o">=</span> <span class="n">Dicke</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">emission</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">test_matrix2</span> <span class="o">=</span> <span class="n">ensemble</span><span class="o">.</span><span class="n">coefficient_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">todense</span><span class="p">()</span>
        <span class="n">true_matrix</span> <span class="o">=</span> <span class="p">[[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">]]</span>
        
        <span class="n">assert_array_almost_equal</span><span class="p">(</span><span class="n">test_matrix</span><span class="p">,</span> <span class="n">true_matrix</span><span class="p">)</span>
        <span class="n">assert_array_almost_equal</span><span class="p">(</span><span class="n">test_matrix2</span><span class="p">,</span> <span class="n">true_matrix</span><span class="p">)</span></div>

<div class="viewcode-block" id="TestPim.test_pisolve"><a class="viewcode-back" href="../../../piqs.tests.html#piqs.tests.test_dicke.TestPim.test_pisolve">[docs]</a>    <span class="k">def</span> <span class="nf">test_pisolve</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test the warning for diagonal Hamiltonians to use internal solver.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">jx</span><span class="p">,</span> <span class="n">jy</span><span class="p">,</span> <span class="n">jz</span> <span class="o">=</span> <span class="n">jspin</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">jp</span><span class="p">,</span> <span class="n">jm</span> <span class="o">=</span> <span class="n">jspin</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="p">),</span> <span class="n">jspin</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span>
        <span class="n">non_diag_hamiltonian</span> <span class="o">=</span> <span class="n">jx</span>
        <span class="n">diag_hamiltonian</span> <span class="o">=</span> <span class="n">jz</span>

        <span class="n">non_diag_system</span> <span class="o">=</span> <span class="n">Dicke</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">non_diag_hamiltonian</span><span class="p">,</span> <span class="n">emission</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="n">diag_system</span> <span class="o">=</span> <span class="n">Dicke</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">diag_hamiltonian</span><span class="p">,</span> <span class="n">emission</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

        <span class="n">diag_initial_state</span> <span class="o">=</span> <span class="n">dicke</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">non_diag_initial_state</span> <span class="o">=</span> <span class="n">ghz</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">tlist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

        <span class="n">assert_raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">non_diag_system</span><span class="o">.</span><span class="n">pisolve</span><span class="p">,</span>
                      <span class="n">diag_initial_state</span><span class="p">,</span> <span class="n">tlist</span><span class="p">)</span>
        <span class="n">assert_raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">non_diag_system</span><span class="o">.</span><span class="n">pisolve</span><span class="p">,</span>
                      <span class="n">non_diag_initial_state</span><span class="p">,</span> <span class="n">tlist</span><span class="p">)</span>
        <span class="n">assert_raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">diag_system</span><span class="o">.</span><span class="n">pisolve</span><span class="p">,</span>
                      <span class="n">non_diag_initial_state</span><span class="p">,</span> <span class="n">tlist</span><span class="p">)</span>

        <span class="n">non_dicke_initial_state</span> <span class="o">=</span> <span class="n">excited</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;uncoupled&#39;</span><span class="p">)</span>
        <span class="n">assert_raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">diag_system</span><span class="o">.</span><span class="n">pisolve</span><span class="p">,</span>
                      <span class="n">non_dicke_initial_state</span><span class="p">,</span> <span class="n">tlist</span><span class="p">)</span>

        <span class="c1"># no Hamiltonian</span>
        <span class="n">no_hamiltonian_system</span> <span class="o">=</span> <span class="n">Dicke</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">emission</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">no_hamiltonian_system</span><span class="o">.</span><span class="n">pisolve</span><span class="p">(</span><span class="n">diag_initial_state</span><span class="p">,</span> <span class="n">tlist</span><span class="p">)</span>
        <span class="n">assert_equal</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">states</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span></div></div>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">run_module_suite</span><span class="p">()</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Nathan Shammah, Shahnawaz Ahmed.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
    </div>

    

    
  </body>
</html>